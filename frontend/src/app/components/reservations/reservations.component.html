<div class="reservations-container px-3 py-4">
  <h2 class="reservations-title">ğŸ—“ï¸ Mis Reservas</h2>

  <div class="row g-4">
    @for (reservation of reservations; track reservation._id) {
      <div class="col-12 col-md-6 col-lg-4 d-flex">
        <div class="reservation-card w-100 d-flex flex-column">

          @if (editingId !== reservation._id) {
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="card-name mb-0">{{ reservation.restaurante?.nombre || 'â€”' }}</h5>
              <span class="badge" [ngClass]="{
                'bg-warning text-dark': reservation.estado === 'pendiente',
                'bg-success': reservation.estado === 'confirmada',
                'bg-secondary': reservation.estado === 'cancelada'
              }">
                {{ reservation.estado | titlecase }}
              </span>
            </div>
            <div class="card-body">
              <p>ğŸ“… <strong>Fecha:</strong> {{ reservation.fecha }}</p>
              <p>ğŸ•’ <strong>Hora:</strong> {{ reservation.hora }}</p>
              <p>ğŸ‘¥ <strong>Personas:</strong> {{ reservation.numeroPersonas }}</p>
              <p>â° <strong>Horario:</strong> {{ reservation.restaurante?.horario || 'â€”' }}</p>
              @if (reservation.estado === 'cancelada') {
                <div class="alert alert-danger mt-3 mb-0" role="alert">
                  âŒ Tu reserva ha sido cancelada por el restaurante.
                </div>
              }
            </div>
            <div class="card-footer d-flex gap-2">
              @if (reservation.estado !== 'cancelada') {
                <button class="btn btn-edit w-50" (click)="startEdit(reservation)">âœï¸ Editar</button>
                <button class="btn btn-cancel w-50" (click)="deleteReservation(reservation._id)">ğŸ—‘ï¸ Cancelar</button>
              } @else {
                <button class="btn btn-secondary w-100" disabled>âŒ Cancelada</button>
              }
            </div>
          } @else {
            <div class="card-body">
              <label class="form-label">ğŸ“… Fecha:</label>
              <input type="date" class="form-control mb-2" [(ngModel)]="editData.fecha" />

              <label class="form-label">ğŸ•’ Hora:</label>
              <input
                type="time"
                class="form-control mb-2"
                [(ngModel)]="editData.hora"
                [min]="horaInicio"
                [max]="horaFin"
              />
              <small class="text-muted">Horario permitido: {{ horaInicio }} - {{ horaFin }}</small><br>

              <label class="form-label mt-2">ğŸ‘¥ Personas:</label>
              <input type="number" min="1" class="form-control" [(ngModel)]="editData.numeroPersonas" />
            </div>
            <div class="card-footer d-flex gap-2">
              <button class="btn btn-success w-50" (click)="saveEdit(reservation._id)">ğŸ’¾ Guardar</button>
              <button class="btn btn-secondary w-50" (click)="cancelEdit()">âœ–ï¸ Cancelar</button>
            </div>


          }
        </div>
      </div>
    }
  </div>

  @if (reservations.length === 0) {
    <p class="text-center text-muted mt-5">No tienes reservas aÃºn.</p>
  }
</div>
